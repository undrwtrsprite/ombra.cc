<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>ombra tools â€” fast, private, beautiful</title>
  <meta name="description" content="A clean collection of fast, private, adâ€‘free tools: image convert, resize, PDF to text, text to PDF, QR code, password generator, and more." />
  <meta name="theme-color" content="#09090b" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" media="print" onload="this.media='all'">
  <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"></noscript>
  <link rel="stylesheet" href="/assets/styles/base.css?v=66" />
  <link rel="manifest" href="/manifest.json" />
  
  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='50' fill='black'/%3E%3Ctext x='50' y='55' font-family='sans-serif' font-size='60' font-weight='bold' fill='white' text-anchor='middle' dominant-baseline='middle'%3Eo%3C/text%3E%3C/svg%3E">
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
</head>
<body>
  <a href="#tools" class="skip-to-content">Skip to content</a>
  <div class="bg-layer bg-gradient"></div>
  <div class="bg-layer bg-mesh"></div>
  <div class="bg-animation" id="bgAnimation"></div>

  <nav class="nav">
    <div class="nav-inner">
      <a href="/" class="logo">ombra</a>
      <div class="nav-links"></div>
      <div class="nav-actions">
        <div class="nav-search collapsed" id="navSearch">
          <span class="nav-search-icon">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M14 14L11.5 11.5L14 14ZM12.5 7C12.5 10.6 9.6 12.5 7 12.5C4.4 12.5 1.5 9.6 1.5 7C1.5 4.4 4.4 1.5 7 1.5C9.6 1.5 12.5 4.4 12.5 7Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </span>
          <input type="search" placeholder="Search tools" aria-label="Search tools" autocomplete="off" />
          <div class="nav-results" id="navResults" aria-live="polite"></div>
        </div>
        <div class="offline-indicator" id="offlineIndicator" style="display: none;">
          <span class="offline-dot"></span>
          <span class="offline-text">Offline</span>
        </div>
        <button id="refreshBtn" class="refresh-btn" title="Force refresh for updates" style="display: none;">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M4.681 3H2V2h3.5l.5.5V6H5V4a5 5 0 1 0 4.53-.761l.302-.954A6 6 0 1 1 4.681 3z" stroke="currentColor" stroke-width="1.2" fill="none"/>
          </svg>
        </button>
        <button id="settingsBtn" class="refresh-btn" title="Settings" aria-label="Settings">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
          </svg>
        </button>
      </div>
    </div>
  </nav>

  <div class="container homepage-return">
    <section class="hero homepage-return">
      <div class="hero-badge">âœ¨ Privacy-first tools</div>
      <h1 class="hero-title">
        <span class="typing-text" data-typing>Tools that just work.</span><span class="typing-cursor"></span>
      </h1>
      <p class="hero-subtitle">Fast, private, and free. No ads, no tracking, no nonsense.</p>

      <div class="hero-actions">
        <a class="btn-primary" href="#tools">Explore tools</a>
      </div>
      <div class="scroll-indicator">
        <div class="scroll-dot"></div>
        <span>Discover tools below</span>
        <div class="scroll-arrow">â†“</div>
      </div>
    </section>

    <div class="content-section" id="tools">
      
      <!-- Frequently Used (Hidden by default, populated by JS) -->
      <div class="tool-category reveal" id="featured-section" style="display: none;">
        <div class="category-header">
          <h3 class="category-title">Frequently Used</h3>
          <div class="category-line"></div>
        </div>
        <div class="tool-list"></div>
      </div>

      <!-- Images & PDFs -->
      <div class="tool-category reveal">
        <div class="category-header">
          <h3 class="category-title">Images & PDFs</h3>
          <div class="category-line"></div>
        </div>
        <div class="tool-list">
          <a class="tool-item" data-tags="images convert" href="/tools/image-converter.html">
            <div class="tool-item-icon">ğŸ–¼ï¸</div>
            <div class="tool-item-content">
              <div class="tool-item-title">Image Converter</div>
              <div class="tool-item-desc">Convert between JPG, PNG, WEBP formats with quality control.</div>
            </div>
            <div class="tool-item-arrow">â†’</div>
          </a>
          <a class="tool-item" data-tags="images compress" href="/tools/image-resizer.html">
            <div class="tool-item-icon">ğŸ“</div>
            <div class="tool-item-content">
              <div class="tool-item-title">Image Resizer</div>
              <div class="tool-item-desc">Resize and compress images while maintaining quality.</div>
            </div>
            <div class="tool-item-arrow">â†’</div>
          </a>
          <a class="tool-item" data-tags="pdf text" href="/tools/pdf-to-text.html">
            <div class="tool-item-icon">ğŸ“„</div>
            <div class="tool-item-content">
              <div class="tool-item-title">PDF to Text</div>
              <div class="tool-item-desc">Extract text from PDFs locally using your device.</div>
            </div>
            <div class="tool-item-arrow">â†’</div>
          </a>
          <a class="tool-item" data-tags="pdf text" href="/tools/text-to-pdf.html">
            <div class="tool-item-icon">ğŸ“</div>
            <div class="tool-item-content">
              <div class="tool-item-title">Text to PDF</div>
              <div class="tool-item-desc">Convert your notes and text into clean PDF documents.</div>
            </div>
            <div class="tool-item-arrow">â†’</div>
          </a>
          <a class="tool-item" data-tags="pdf" href="/tools/pdf-merge.html">
            <div class="tool-item-icon">ğŸ“</div>
            <div class="tool-item-content">
              <div class="tool-item-title">PDF Merger</div>
              <div class="tool-item-desc">Combine multiple PDFs into one. Fast and private.</div>
            </div>
            <div class="tool-item-arrow">â†’</div>
          </a>
          <a class="tool-item" data-tags="images pdf convert" href="/tools/image-to-pdf.html">
            <div class="tool-item-icon">ğŸ–¼ï¸</div>
            <div class="tool-item-content">
              <div class="tool-item-title">Image to PDF</div>
              <div class="tool-item-desc">Turn images into a single PDF with custom page sizes.</div>
            </div>
            <div class="tool-item-arrow">â†’</div>
          </a>
          <a class="tool-item" data-tags="images convert" href="/tools/heic-to-jpg.html">
            <div class="tool-item-icon">ğŸ“±</div>
            <div class="tool-item-content">
              <div class="tool-item-title">HEIC to JPG</div>
              <div class="tool-item-desc">Convert iPhone HEIC photos to JPG or PNG instantly.</div>
            </div>
            <div class="tool-item-arrow">â†’</div>
          </a>
          <a class="tool-item" data-tags="compress" href="/tools/file-compressor.html">
            <div class="tool-item-icon">ğŸ—œï¸</div>
            <div class="tool-item-content">
              <div class="tool-item-title">File Compressor</div>
              <div class="tool-item-desc">Compress images, documents, and files to reduce size.</div>
            </div>
            <div class="tool-item-arrow">â†’</div>
          </a>
        </div>
      </div>

      <!-- Text & Data -->
      <div class="tool-category reveal">
        <div class="category-header">
          <h3 class="category-title">Text & Data</h3>
          <div class="category-line"></div>
        </div>
        <div class="tool-list">
          <a class="tool-item" data-tags="qr" href="/tools/qr.html">
            <div class="tool-item-icon">ğŸ”—</div>
            <div class="tool-item-content">
              <div class="tool-item-title">QR Code Generator</div>
              <div class="tool-item-desc">Create QR codes from any text or URL.</div>
            </div>
            <div class="tool-item-arrow">â†’</div>
          </a>
          <a class="tool-item" data-tags="images" href="/tools/color-picker.html">
            <div class="tool-item-icon">ğŸ¨</div>
            <div class="tool-item-content">
              <div class="tool-item-title">Color Picker</div>
              <div class="tool-item-desc">Pick colors from images and generate palettes.</div>
            </div>
            <div class="tool-item-arrow">â†’</div>
          </a>
          <a class="tool-item" data-tags="text" href="/tools/text-case.html">
            <div class="tool-item-icon">ğŸ“</div>
            <div class="tool-item-content">
              <div class="tool-item-title">Text Case Converter</div>
              <div class="tool-item-desc">Convert text between UPPERCASE, lowercase, and more.</div>
            </div>
            <div class="tool-item-arrow">â†’</div>
          </a>
          <a class="tool-item" data-tags="data" href="/tools/json-formatter.html">
            <div class="tool-item-icon">âš¡</div>
            <div class="tool-item-content">
              <div class="tool-item-title">JSON Formatter</div>
              <div class="tool-item-desc">Format, validate, and beautify JSON data.</div>
            </div>
            <div class="tool-item-arrow">â†’</div>
          </a>
          <a class="tool-item" data-tags="text" href="/tools/markdown.html">
            <div class="tool-item-icon">ğŸ“–</div>
            <div class="tool-item-content">
              <div class="tool-item-title">Markdown Editor</div>
              <div class="tool-item-desc">Write and preview Markdown with live rendering.</div>
            </div>
            <div class="tool-item-arrow">â†’</div>
          </a>
          <a class="tool-item" data-tags="text" href="/tools/notepad.html">
            <div class="tool-item-icon">ğŸ“</div>
            <div class="tool-item-content">
              <div class="tool-item-title">Smart Notepad</div>
              <div class="tool-item-desc">Rich text editor with auto-save and export options.</div>
            </div>
            <div class="tool-item-arrow">â†’</div>
          </a>
          <a class="tool-item" data-tags="text utility" href="/tools/text-diff.html">
            <div class="tool-item-icon">ğŸ§©</div>
            <div class="tool-item-content">
              <div class="tool-item-title">Text Diff</div>
              <div class="tool-item-desc">Compare two texts and highlight differences.</div>
            </div>
            <div class="tool-item-arrow">â†’</div>
          </a>
          <a class="tool-item" data-tags="data utility" href="/tools/json-to-csv.html">
            <div class="tool-item-icon">ğŸ”„</div>
            <div class="tool-item-content">
              <div class="tool-item-title">Data Converter</div>
              <div class="tool-item-desc">Convert between JSON and CSV formats.</div>
            </div>
            <div class="tool-item-arrow">â†’</div>
          </a>
        </div>
      </div>

      <!-- Utilities -->
      <div class="tool-category reveal">
        <div class="category-header">
          <h3 class="category-title">Utilities</h3>
          <div class="category-line"></div>
        </div>
        <div class="tool-list">
          <a class="tool-item" data-tags="qr utility" href="/tools/qr-scanner.html">
            <div class="tool-item-icon">ğŸ“·</div>
            <div class="tool-item-content">
              <div class="tool-item-title">QR Scanner</div>
              <div class="tool-item-desc">Scan QR codes using your camera.</div>
            </div>
            <div class="tool-item-arrow">â†’</div>
          </a>
          <a class="tool-item" data-tags="convert utility" href="/tools/unit-converter.html">
            <div class="tool-item-icon">ğŸ“Š</div>
            <div class="tool-item-content">
              <div class="tool-item-title">Unit Converter</div>
              <div class="tool-item-desc">Convert between length, weight, temperature, and more.</div>
            </div>
            <div class="tool-item-arrow">â†’</div>
          </a>
          <a class="tool-item" data-tags="utility" href="/tools/stopwatch.html">
            <div class="tool-item-icon">â±ï¸</div>
            <div class="tool-item-content">
              <div class="tool-item-title">Stopwatch & Timer</div>
              <div class="tool-item-desc">Precise stopwatch and countdown timer.</div>
            </div>
            <div class="tool-item-arrow">â†’</div>
          </a>
          <a class="tool-item" data-tags="convert utility" href="/tools/currency-converter.html">
            <div class="tool-item-icon">ğŸ’±</div>
            <div class="tool-item-content">
              <div class="tool-item-title">Currency Converter</div>
              <div class="tool-item-desc">Real-time currency conversion with live rates.</div>
            </div>
            <div class="tool-item-arrow">â†’</div>
          </a>
          <a class="tool-item" data-tags="utility" href="/tools/password-generator.html">
            <div class="tool-item-icon">ğŸ”</div>
            <div class="tool-item-content">
              <div class="tool-item-title">Password Generator</div>
              <div class="tool-item-desc">Generate secure passwords with custom options.</div>
            </div>
            <div class="tool-item-arrow">â†’</div>
          </a>
        </div>
      </div>

      <!-- IT & Network -->
      <div class="tool-category reveal">
        <div class="category-header">
          <h3 class="category-title">IT & Network</h3>
          <div class="category-line"></div>
        </div>
        <div class="tool-list">
          <a class="tool-item" data-tags="network utility" href="/tools/ip-calculator.html">
            <div class="tool-item-icon">ğŸŒ</div>
            <div class="tool-item-content">
              <div class="tool-item-title">IP Calculator</div>
              <div class="tool-item-desc">Calculate subnet masks and network addresses.</div>
            </div>
            <div class="tool-item-arrow">â†’</div>
          </a>
          <a class="tool-item" data-tags="network utility" href="/tools/ip-info.html">
            <div class="tool-item-icon">ğŸ›°ï¸</div>
            <div class="tool-item-content">
              <div class="tool-item-title">IP Info</div>
              <div class="tool-item-desc">Detect your public IP, ISP, and location.</div>
            </div>
            <div class="tool-item-arrow">â†’</div>
          </a>
          <a class="tool-item" data-tags="network utility" href="/tools/whois-lookup.html">
            <div class="tool-item-icon">ğŸ“‡</div>
            <div class="tool-item-content">
              <div class="tool-item-title">WHOIS Lookup</div>
              <div class="tool-item-desc">Query domain registration details.</div>
            </div>
            <div class="tool-item-arrow">â†’</div>
          </a>
          <a class="tool-item" data-tags="network utility" href="/tools/dns-lookup.html">
            <div class="tool-item-icon">ğŸ”</div>
            <div class="tool-item-content">
              <div class="tool-item-title">DNS Lookup</div>
              <div class="tool-item-desc">Query DNS records for any domain.</div>
            </div>
            <div class="tool-item-arrow">â†’</div>
          </a>
          <a class="tool-item" data-tags="utility data" href="/tools/unix-time.html">
            <div class="tool-item-icon">â°</div>
            <div class="tool-item-content">
              <div class="tool-item-title">Unix Time Converter</div>
              <div class="tool-item-desc">Convert between Unix epoch and human time.</div>
            </div>
            <div class="tool-item-arrow">â†’</div>
          </a>
        </div>
      </div>

      <section class="cta-section reveal">
        <h2 class="cta-title">Privacy by design</h2>
        <p class="cta-description">Everything runs in your browser. Your files never leave your device, and we never see your data.</p>
        <div class="button-group">
          <a class="btn-primary" href="#tools">Start using tools</a>
        </div>
      </section>
    </div>
  </div>

  <footer class="footer">
    <p>Â© 2025 ombra. Built with care and privacy in mind.</p>
  </footer>

  <!-- Settings Modal -->
  <div id="settingsModal" class="modal-overlay drawer drawer-bottom">
    <div class="modal-card">
      <button class="drawer-close modal-close" aria-label="Close">Ã—</button>
      <div class="modal-header" style="margin-bottom: 20px;">
        <h2 style="margin: 0; font-size: 24px;">Settings</h2>
      </div>
      <div class="modal-body">
        <div class="settings-group">
          <h3>Appearance</h3>
          <div class="setting-item">
            <div>
              <div class="setting-label">Reduce Motion</div>
              <div class="setting-desc">Minimize animations for better performance</div>
            </div>
            <label class="switch">
              <input type="checkbox" id="motionToggle">
              <span class="slider"></span>
            </label>
          </div>
        </div>
        <div class="settings-group">
          <h3>Data</h3>
          <div class="setting-item">
            <div>
              <div class="setting-label">Clear Local Data</div>
              <div class="setting-desc">Reset all tool preferences and history</div>
            </div>
            <button class="btn-secondary" id="clearDataBtn" style="padding: 6px 12px; font-size: 13px;">Clear</button>
          </div>
        </div>
        <div style="text-align: center; margin-top: 20px; color: var(--text-muted); font-size: 12px;">
          ombra tools v1.0.0
        </div>
      </div>
    </div>
  </div>

  <script>
    // Ensure hero text is visible immediately on low-end devices (runs before effects.js)
    (function() {
      const typingNodes = document.querySelectorAll('.typing-text');
      typingNodes.forEach(node => {
        if (!node.textContent.trim()) {
          node.textContent = "Tools that just work.";
        }
      });
    })();
  </script>
  <script src="/assets/scripts/help.js?v=66"></script>
  <script src="/assets/scripts/keyboard-shortcuts.js?v=66"></script>
  <script src="/assets/scripts/toast.js?v=66"></script>
  <script src="/assets/scripts/modal.js?v=66"></script>
  <script src="/assets/scripts/settings.js?v=66"></script>
  <script src="/assets/scripts/visitor-counter.js?v=66"></script>
  <script src="/assets/scripts/usage-tracker.js?v=66"></script>
  <script src="/assets/scripts/effects.js?v=66"></script>
  <script>
    // Simple client-side filtering of tool cards
    const categories = Array.from(document.querySelectorAll('.tool-category'));

    // Filters removed

    // Wire up nav search to the same filter
    const navSearch = document.getElementById('navSearch');
    const navResults = document.getElementById('navResults');
    const searchInput = navSearch.querySelector('input[type="search"]');
    
    // Settings button handler (inline fallback)
    const settingsBtn = document.getElementById('settingsBtn');
    const settingsModal = document.getElementById('settingsModal');
    if (settingsBtn && settingsModal) {
      settingsBtn.addEventListener('click', (e) => {
        e.preventDefault();
        if (window.Modal && window.Modal.open) {
          window.Modal.open(settingsModal, { position: 'bottom' });
        } else {
          settingsModal.classList.add('drawer-bottom');
          void settingsModal.offsetWidth; // Force reflow
          settingsModal.classList.add('visible');
        }
      });
    }

    // Build an index of tools for suggestions
    const toolItems = Array.from(document.querySelectorAll('.tool-item'));
    const toolIndex = toolItems.map(item => ({
      href: item.getAttribute('href'),
      title: item.querySelector('.tool-item-title')?.textContent || '',
      desc: item.querySelector('.tool-item-desc')?.textContent || '',
      icon: item.querySelector('.tool-item-icon')?.textContent || 'â€¢'
    }));
    
    if (navSearch && searchInput) {
      // Expand search on click
      navSearch.addEventListener('click', (e) => {
        if (e.target === navSearch || e.target === searchInput) {
          navSearch.classList.remove('collapsed');
          navSearch.classList.add('expanded');
          document.querySelector('.nav').classList.add('search-active');
          searchInput.focus();
        }
      });
      
      // Collapse search on blur (when clicking outside)
      searchInput.addEventListener('blur', () => {
        if (!searchInput.value.trim()) {
          setTimeout(() => {
            navSearch.classList.remove('expanded');
            navSearch.classList.add('collapsed');
            document.querySelector('.nav').classList.remove('search-active');
          }, 200);
        }
      });
      
      // Debounce function for search performance
      let searchTimeout;
      const debounceSearch = (callback, delay = 150) => {
        clearTimeout(searchTimeout);
        searchTimeout = setTimeout(callback, delay);
      };
      
      // Keep expanded if there's text
      searchInput.addEventListener('input', () => {
        const q = searchInput.value.trim();
        if (q) {
          navSearch.classList.remove('collapsed');
          navSearch.classList.add('expanded');
          document.querySelector('.nav').classList.add('search-active');
        }
        
        // Debounce search operations
        debounceSearch(() => {
          // Filter tools on page
          const showAll = !q;
          categories.forEach(category => {
            const items = Array.from(category.querySelectorAll('.tool-item'));
            let visibleCount = 0;
            items.forEach(item => {
              const title = item.querySelector('.tool-item-title')?.textContent.toLowerCase() || '';
              const desc = item.querySelector('.tool-item-desc')?.textContent.toLowerCase() || '';
              const tags = (item.getAttribute('data-tags') || '').toLowerCase();
              const match = showAll || title.includes(q) || desc.includes(q) || tags.includes(q);
              item.style.display = match ? '' : 'none';
              if (match) visibleCount++;
            });
            category.style.display = visibleCount > 0 ? '' : 'none';
          });
          
          // Suggestions dropdown
          const query = q.toLowerCase();
          if (!navResults) return;
          if (!query) { navResults.style.display = 'none'; navResults.innerHTML=''; return; }
          const matches = toolIndex.filter(t =>
            t.title.toLowerCase().includes(query) ||
            t.desc.toLowerCase().includes(query) ||
            t.href.toLowerCase().includes(query)
          ).slice(0, 6);
          if (matches.length === 0) { navResults.style.display = 'none'; navResults.innerHTML=''; return; }
          navResults.innerHTML = matches.map(m => `
            <a class="result-item" href="${m.href}">
              <div class="result-icon-wrapper">${m.icon}</div>
              <div class="result-content">
                <span class="title">${m.title}</span>
                <span class="desc">${m.desc}</span>
              </div>
              <div class="result-arrow">â†’</div>
            </a>
          `).join('');
          navResults.style.display = 'block';
        });
      });
      
      // Hide on blur after a short delay to allow click
      searchInput.addEventListener('blur', () => setTimeout(() => { if (navResults) navResults.style.display = 'none'; }, 200));
      // Show again on focus if there is a query
      searchInput.addEventListener('focus', () => { if (searchInput.value.trim() && navResults) navResults.style.display = 'block'; });
    }
    
    // Enhanced low-power mode detection
    const lowPowerMode = (() => {
      const prefersReduce = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      const lowCores = navigator.hardwareConcurrency && navigator.hardwareConcurrency <= 4;
      const lowMemory = navigator.deviceMemory && navigator.deviceMemory <= 4;
      
      // Check connection speed (if available)
      const connection = navigator.connection || navigator.mozConnection || navigator.webkitConnection;
      const slowConnection = connection && (connection.effectiveType === 'slow-2g' || connection.effectiveType === '2g' || connection.saveData);
      
      // Check battery status (if available)
      let lowBattery = false;
      if (navigator.getBattery) {
        navigator.getBattery().then(battery => {
          if (battery.level < 0.2 || battery.charging === false) {
            lowBattery = true;
            if (lowBattery) {
              document.body.classList.add('reduce-effects');
            }
          }
        }).catch(() => {});
      }
      
      // Check for mobile devices (often lower performance)
      const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
      
      // Check viewport size (smaller screens often have less power)
      const isSmallScreen = window.innerWidth <= 768;
      
      return prefersReduce || lowCores || lowMemory || slowConnection || (isMobile && isSmallScreen);
    })();
    
    if (lowPowerMode) {
      document.body.classList.add('reduce-effects');
      // Disable expensive effects
      const bgMesh = document.querySelector('.bg-mesh');
      if (bgMesh) {
        bgMesh.style.animation = 'none';
        bgMesh.style.filter = 'none';
      }
    }
    
    // Animated background particles - optimized for performance
    function createParticles() {
      if (lowPowerMode) {
        // Completely disable particles on low-power mode
        const container = document.getElementById('bgAnimation');
        if (container) container.style.display = 'none';
        return;
      }
      
      const container = document.getElementById('bgAnimation');
      if (!container) return;
      
      // Detect very low-end devices
      const veryLowEnd = (navigator.hardwareConcurrency && navigator.hardwareConcurrency <= 2) ||
                         (navigator.deviceMemory && navigator.deviceMemory <= 2);
      
      // Reduce particles: 2 for low-end, 4 for normal devices
      const particleCount = veryLowEnd ? 0 : (lowPowerMode ? 0 : 2);
      
      if (particleCount === 0) {
        container.style.display = 'none';
        return;
      }
      
      // Create particles
      for (let i = 0; i < particleCount; i++) {
        const particle = document.createElement('div');
        particle.className = 'floating-particle';
        
        // Simple positioning and timing
        particle.style.left = Math.random() * 100 + '%';
        particle.style.animationDelay = Math.random() * 20 + 's';
        
        container.appendChild(particle);
      }
    }
    
    // Initialize particles when page loads (deferred)
    if ('requestIdleCallback' in window) {
      requestIdleCallback(createParticles, { timeout: 3000 });
    } else {
      setTimeout(createParticles, 1000);
    }
    
    // Check if returning from a tool and trigger smooth return animation
    if (sessionStorage.getItem('returningFromTool')) {
      sessionStorage.removeItem('returningFromTool');
      
      // Ensure text is visible when returning
      const typingNodes = document.querySelectorAll('.typing-text');
      typingNodes.forEach(node => {
        if (!node.textContent.trim()) {
          node.textContent = "Tools that just work.";
        }
      });
      
      // Ensure cards are visible when returning
      const cards = document.querySelectorAll('.glass-card');
      cards.forEach(card => {
        card.classList.add('visible');
        card.style.opacity = '1';
        card.style.transform = 'translateY(0)';
      });
      
      const cardGrids = document.querySelectorAll('.cards-grid');
      cardGrids.forEach(grid => {
        grid.classList.add('visible');
        grid.style.opacity = '1';
        grid.style.transform = 'translateY(0)';
      });
      
      // Trigger the return animation smoothly
      const returnElements = document.querySelectorAll('.homepage-return');
      returnElements.forEach(el => {
        el.style.animation = 'none';
        el.offsetHeight; // Trigger reflow
        el.style.animation = null;
      });
    }
    
    // Performance optimization: pause animations when page is not visible
    document.addEventListener('visibilitychange', () => {
      const particles = document.querySelectorAll('.floating-particle');
      const bgMesh = document.querySelector('.bg-mesh');
      
      if (document.hidden) {
        particles.forEach(p => p.style.animationPlayState = 'paused');
        if (bgMesh) bgMesh.style.animationPlayState = 'paused';
      } else {
        particles.forEach(p => p.style.animationPlayState = 'running');
        if (bgMesh) bgMesh.style.animationPlayState = 'running';
      }
    });
    
    // Service Worker Registration for offline support
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/sw.js')
          .then(registration => {
            console.log('Service Worker registered successfully:', registration.scope);
            
            // Check for updates
            registration.addEventListener('updatefound', () => {
              const newWorker = registration.installing;
              newWorker.addEventListener('statechange', () => {
                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                  // New version available - force refresh
                  console.log('New version available, refreshing...');
                  window.location.reload();
                }
              });
            });
            
            // Handle service worker updates
            navigator.serviceWorker.addEventListener('controllerchange', () => {
              console.log('Service Worker updated, refreshing...');
              window.location.reload();
            });
          })
          .catch(error => {
            console.log('Service Worker registration failed:', error);
          });
      });
      
      // Force refresh if service worker is controlling
      if (navigator.serviceWorker.controller) {
        navigator.serviceWorker.controller.postMessage({ type: 'SKIP_WAITING' });
      }
      
      // Show refresh button in development
      const refreshBtn = document.getElementById('refreshBtn');
      if (refreshBtn) {
        refreshBtn.style.display = 'block';
        refreshBtn.addEventListener('click', () => {
          // Clear all caches and reload
          if ('caches' in window) {
            caches.keys().then(names => {
              names.forEach(name => caches.delete(name));
            });
          }
          window.location.reload(true);
        });
      }
    }
    
    // Offline/Online detection
    function updateOfflineStatus() {
      const offlineIndicator = document.getElementById('offlineIndicator');
      if (offlineIndicator) {
        if (!navigator.onLine) {
          offlineIndicator.style.display = 'flex';
        } else {
          offlineIndicator.style.display = 'none';
        }
      }
    }
    
    // Listen for online/offline events
    window.addEventListener('online', updateOfflineStatus);
    window.addEventListener('offline', updateOfflineStatus);
    
    // Check initial status
    updateOfflineStatus();
  </script>
</body>
</html>