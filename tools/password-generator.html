<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Password Generator - Ombra Tools</title>
    <link rel="stylesheet" href="../assets/styles/base.css">
</head>
<body>
    <div class="bg-layer bg-gradient"></div>
    <div class="bg-layer bg-mesh"></div>
    <div class="bg-animation" id="bgAnimation"></div>



    <main class="tool-container">
        <div class="tool-card">
            <div class="tool-header">
                <div class="tool-icon">üîê</div>
                <h1>Password Generator</h1>
            </div>
            
            <div class="tool-body">
                <div class="control-row">
                    <label for="passwordLength">Length:</label>
                    <input type="range" id="passwordLength" min="8" max="128" value="16" class="range-slider">
                    <span id="lengthDisplay">16</span>
                </div>

                <div class="control-row">
                    <label>
                        <input type="checkbox" id="uppercase" checked> Uppercase (A-Z)
                    </label>
                    <label>
                        <input type="checkbox" id="lowercase" checked> Lowercase (a-z)
                    </label>
                    <label>
                        <input type="checkbox" id="numbers" checked> Numbers (0-9)
                    </label>
                    <label>
                        <input type="checkbox" id="symbols" checked> Symbols (!@#$%^&*)
                    </label>
                </div>

                <div class="control-row">
                    <label>
                        <input type="checkbox" id="excludeSimilar"> Exclude similar characters (l, 1, I, O, 0)
                    </label>
                    <label>
                        <input type="checkbox" id="excludeAmbiguous"> Exclude ambiguous characters ({}, [], |, \, /)
                    </label>
                </div>

                <div class="control-row">
                    <button class="btn-primary" onclick="generatePassword()">Generate Password</button>
                    <button class="btn-secondary" onclick="generateMultiple()">Generate 5 Passwords</button>
                </div>

                <div class="result" id="result" style="display: none;">
                    <h3>Generated Password</h3>
                    <div class="password-display">
                        <input type="text" id="generatedPassword" readonly>
                        <button class="btn-primary" onclick="copyPassword()">Copy</button>
                    </div>
                    <div class="password-strength" id="passwordStrength"></div>
                </div>

                <div class="result" id="multipleResult" style="display: none;">
                    <h3>Multiple Passwords</h3>
                    <div class="multiple-passwords" id="multiplePasswords"></div>
                </div>

                <div class="result">
                    <h3>Password Strength Checker</h3>
                    <div class="control-row">
                        <label for="checkPassword">Check Password:</label>
                        <input type="text" id="checkPassword" placeholder="Enter password to check strength">
                        <button class="btn-secondary" onclick="checkPasswordStrength()">Check</button>
                    </div>
                    <div class="strength-meter" id="strengthMeter"></div>
                </div>
            </div>
        </div>
    </main>

    <script src="../assets/scripts/back-button.js"></script>
    <script>
        const lengthSlider = document.getElementById('passwordLength');
        const lengthDisplay = document.getElementById('lengthDisplay');
        const result = document.getElementById('result');
        const multipleResult = document.getElementById('multipleResult');

        lengthSlider.addEventListener('input', function() {
            lengthDisplay.textContent = this.value;
        });

        function generatePassword() {
            const length = parseInt(document.getElementById('passwordLength').value);
            const useUppercase = document.getElementById('uppercase').checked;
            const useLowercase = document.getElementById('lowercase').checked;
            const useNumbers = document.getElementById('numbers').checked;
            const useSymbols = document.getElementById('symbols').checked;
            const excludeSimilar = document.getElementById('excludeSimilar').checked;
            const excludeAmbiguous = document.getElementById('excludeAmbiguous').checked;

            if (!useUppercase && !useLowercase && !useNumbers && !useSymbols) {
                alert('Please select at least one character type.');
                return;
            }

            let charset = '';
            if (useUppercase) charset += 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            if (useLowercase) charset += 'abcdefghijklmnopqrstuvwxyz';
            if (useNumbers) charset += '0123456789';
            if (useSymbols) charset += '!@#$%^&*()_+-=[]{}|;:,.<>?';

            if (excludeSimilar) {
                charset = charset.replace(/[l1IO0]/g, '');
            }
            if (excludeAmbiguous) {
                charset = charset.replace(/[{}[\]|\\/]/g, '');
            }

            let password = '';
            const array = new Uint32Array(length);
            crypto.getRandomValues(array);

            for (let i = 0; i < length; i++) {
                password += charset[array[i] % charset.length];
            }

            document.getElementById('generatedPassword').value = password;
            result.style.display = 'block';
            multipleResult.style.display = 'none';
            
            updatePasswordStrength(password);
        }

        function generateMultiple() {
            const passwords = [];
            for (let i = 0; i < 5; i++) {
                generatePassword();
                passwords.push(document.getElementById('generatedPassword').value);
            }

            const container = document.getElementById('multiplePasswords');
            container.innerHTML = passwords.map((pwd, index) => `
                <div class="password-item">
                    <span class="password-number">${index + 1}.</span>
                    <input type="text" value="${pwd}" readonly>
                    <button class="btn-secondary" onclick="copySpecificPassword('${pwd}')">Copy</button>
                </div>
            `).join('');

            result.style.display = 'none';
            multipleResult.style.display = 'block';
        }

        function copyPassword() {
            const password = document.getElementById('generatedPassword').value;
            copyToClipboard(password);
        }

        function copySpecificPassword(password) {
            copyToClipboard(password);
        }

        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                // Show feedback
                const buttons = document.querySelectorAll('.btn-primary, .btn-secondary');
                buttons.forEach(btn => {
                    if (btn.textContent === 'Copy') {
                        const originalText = btn.textContent;
                        btn.textContent = 'Copied!';
                        btn.style.background = 'linear-gradient(135deg, #10b981, #059669)';
                        setTimeout(() => {
                            btn.textContent = originalText;
                            btn.style.background = '';
                        }, 1000);
                    }
                });
            }).catch(err => {
                // Fallback for older browsers
                const textArea = document.createElement('textarea');
                textArea.value = text;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                
                // Show feedback
                const buttons = document.querySelectorAll('.btn-primary, .btn-secondary');
                buttons.forEach(btn => {
                    if (btn.textContent === 'Copy') {
                        const originalText = btn.textContent;
                        btn.textContent = 'Copied!';
                        btn.style.background = 'linear-gradient(135deg, #10b981, #059669)';
                        setTimeout(() => {
                            btn.textContent = originalText;
                            btn.style.background = '';
                        }, 1000);
                    }
                });
            });
        }

        function updatePasswordStrength(password) {
            const strength = calculatePasswordStrength(password);
            const strengthDiv = document.getElementById('passwordStrength');
            
            let strengthText = '';
            let strengthClass = '';
            
            if (strength.score >= 80) {
                strengthText = 'Very Strong';
                strengthClass = 'very-strong';
            } else if (strength.score >= 60) {
                strengthText = 'Strong';
                strengthClass = 'strong';
            } else if (strength.score >= 40) {
                strengthText = 'Medium';
                strengthClass = 'medium';
            } else if (strength.score >= 20) {
                strengthText = 'Weak';
                strengthClass = 'weak';
            } else {
                strengthText = 'Very Weak';
                strengthClass = 'very-weak';
            }

            strengthDiv.innerHTML = `
                <div class="strength-info">
                    <span class="strength-label">Strength: <span class="${strengthClass}">${strengthText}</span></span>
                    <div class="strength-bar">
                        <div class="strength-fill ${strengthClass}" style="width: ${strength.score}%"></div>
                    </div>
                    <div class="strength-details">
                        <span>Score: ${strength.score}/100</span>
                        <span>Entropy: ${strength.entropy.toFixed(1)} bits</span>
                    </div>
                </div>
            `;
        }

        function calculatePasswordStrength(password) {
            let score = 0;
            let entropy = 0;
            
            // Length contribution
            score += Math.min(password.length * 4, 25);
            
            // Character variety
            let charsetSize = 0;
            if (/[a-z]/.test(password)) charsetSize += 26;
            if (/[A-Z]/.test(password)) charsetSize += 26;
            if (/[0-9]/.test(password)) charsetSize += 10;
            if (/[^a-zA-Z0-9]/.test(password)) charsetSize += 32;
            
            // Entropy calculation
            entropy = Math.log2(Math.pow(charsetSize, password.length));
            
            // Bonus for variety
            if (charsetSize >= 62) score += 15;
            else if (charsetSize >= 52) score += 10;
            else if (charsetSize >= 36) score += 5;
            
            // Penalty for patterns
            if (/(.)\1{2,}/.test(password)) score -= 10; // Repeated characters
            if (/123|abc|qwe/i.test(password)) score -= 15; // Common sequences
            
            // Bonus for mixed case
            if (/[a-z]/.test(password) && /[A-Z]/.test(password)) score += 10;
            
            // Bonus for numbers and symbols
            if (/[0-9]/.test(password)) score += 10;
            if (/[^a-zA-Z0-9]/.test(password)) score += 10;
            
            score = Math.max(0, Math.min(100, score));
            
            return { score, entropy };
        }

        function checkPasswordStrength() {
            const password = document.getElementById('checkPassword').value;
            if (password) {
                updatePasswordStrength(password);
            }
        }

        // Generate initial password
        generatePassword();
    </script>

    <style>
        .password-display {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-bottom: 20px;
        }

        .password-display input {
            flex: 1;
            font-family: monospace;
            font-size: 16px;
        }

        .multiple-passwords {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .password-item {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .password-number {
            font-weight: 600;
            min-width: 30px;
        }

        .password-item input {
            flex: 1;
            font-family: monospace;
        }

        .strength-info {
            margin-top: 15px;
        }

        .strength-label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .strength-bar {
            width: 100%;
            height: 8px;
            background: rgba(255,255,255,0.1);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .strength-fill {
            height: 100%;
            transition: width 0.3s ease;
        }

        .strength-details {
            display: flex;
            gap: 20px;
            font-size: 14px;
            color: #cbd5e1;
        }

        .very-weak { background: #ef4444; }
        .weak { background: #f97316; }
        .medium { background: #eab308; }
        .strong { background: #22c55e; }
        .very-strong { background: #10b981; }

        .range-slider {
            width: 200px;
        }

        .control-row label {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
        }

        .control-row input[type="checkbox"] {
            width: auto;
            margin: 0;
        }
    </style>
</body>
</html>
